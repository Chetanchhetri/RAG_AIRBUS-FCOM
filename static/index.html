<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A320 Technical Intelligence</title>
<link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@300;400;600&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  :root {
    --brand-blue: #002b5c;
    --sky-accent: #007aff;
    --bg-main: #f5f7fa;
    --surface: #ffffff;
    --text-primary: #1d1d1f;
    --text-secondary: #86868b;
    --radius: 12px;
  }

  * { box-sizing: border-box; -webkit-font-smoothing: antialiased; }

  body {
    font-family: 'Inter', -apple-system, sans-serif;
    background-color: var(--bg-main);
    color: var(--text-primary);
    margin: 0;
    display: flex;
    justify-content: center;
    padding: 60px 20px;
  }

  .app-container {
    width: 100%;
    max-width: 960px;
    animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
  }

  @keyframes slideUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Header Section */
  .header {
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    margin-bottom: 32px;
    padding: 0 10px;
  }

  .header h1 {
    font-family: 'SF Pro Display', sans-serif;
    font-size: 32px;
    font-weight: 600;
    margin: 0;
    letter-spacing: -0.5px;
  }

  .header .meta {
    text-align: right;
    font-size: 13px;
    color: var(--text-secondary);
  }

  /* Bento Grid Layout */
  .grid {
    display: grid;
    grid-template-columns: 1.5fr 1fr;
    gap: 20px;
  }

  .card {
    background: var(--surface);
    border-radius: var(--radius);
    padding: 24px;
    box-shadow: 0 4px 24px rgba(0,0,0,0.04);
  }

  /* Input Card */
  .query-card { grid-column: span 1; }

  label {
    display: block;
    font-size: 14px;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--brand-blue);
  }

  textarea {
    width: 100%;
    height: 140px;
    border: 1px solid #e5e5e7;
    border-radius: 8px;
    padding: 16px;
    font-size: 16px;
    font-family: inherit;
    background: #fbfbfd;
    resize: none;
    transition: all 0.2s ease;
  }

  textarea:focus {
    outline: none;
    border-color: var(--sky-accent);
    background: #fff;
    box-shadow: 0 0 0 4px rgba(0,122,255,0.1);
  }

  .action-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 16px;
  }

  .btn-primary {
    background: var(--brand-blue);
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 20px;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.1s ease;
  }

  .btn-primary:active { transform: scale(0.96); }

  /* Image Card */
  .media-card {
    background: #000;
    padding: 0;
    overflow: hidden;
    position: relative;
    display: flex;
    align-items: center;
  }

  .media-card img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    opacity: 0.9;
  }

  .source-tag {
    position: absolute;
    bottom: 16px; left: 16px;
    background: rgba(255,255,255,0.9);
    padding: 4px 10px;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 700;
    color: var(--brand-blue);
  }

  /* Response Card */
  .response-card {
    grid-column: span 2;
    min-height: 200px;
    border-top: 4px solid var(--sky-accent);
  }

  /* Animation for Workflow */
  .loader {
    display: none;
    gap: 4px;
    margin-bottom: 15px;
  }

  .dot {
    width: 8px; height: 8px;
    background: var(--sky-accent);
    border-radius: 50%;
    animation: pulse 1.5s infinite ease-in-out;
  }
  .dot:nth-child(2) { animation-delay: 0.2s; }
  .dot:nth-child(3) { animation-delay: 0.4s; }

  @keyframes pulse {
    0%, 100% { transform: scale(0.8); opacity: 0.5; }
    50% { transform: scale(1.2); opacity: 1; }
  }

  #answer-content {
    line-height: 1.6;
    color: #3a3a3c;
  }

</style>
</head>
<body>

<div class="app-container">
  <header class="header">
    <div>
      <h1>A320 FCOM Assistant</h1>
      <div style="color: var(--sky-accent); font-weight: 600; font-size: 13px;">Official Training Dataset: AIRBUS.COM</div>
    </div>

  </header>

  <div class="grid">
    <div class="card query-card">
      <label>Technical System Query</label>
      <textarea id="question" placeholder="e.g. Blue Hydraulic System architecture and priority valve operation..."></textarea>
      
      <div class="action-bar">
        <span id="status-text" style="font-size: 12px; color: var(--text-secondary);">System Ready</span>
        <button class="btn-primary" onclick="ask()">Query Manual</button>
      </div>
    </div>

    <div class="card media-card">
      <div class="source-tag">A320 FAMILY REFERENCE</div>
      <img src="https://mediarenditions.airbus.com/C8zxb98-6uwmNYmzy3J9BrETomGRyJ8YAYSKborwyJ8/resize?src=kpkp://airbus/38/557/557215-qq5vib79cs.jpg&w=2700&h=1800&t=fit&f=webp" >
    </div>

    <div class="card response-card">
      <div class="loader" id="loader">
        <div class="dot"></div><div class="dot"></div><div class="dot"></div>
      </div>
      <div id="answer-content">
        <p style="color: var(--text-secondary);">Enter a technical query above to retrieve data from the indexed Airbus Flight Crew Operating Manual.</p>
      </div>
    </div>
  </div>
</div>

<script>
async function ask() {
  const question = document.getElementById("question").value;
  const answerContent = document.getElementById("answer-content");
  const loader = document.getElementById("loader");
  const status = document.getElementById("status-text");

  if (!question.trim()) return;

  // UI States
  loader.style.display = "flex";
  status.innerText = "Processing RAG Workflow...";
  answerContent.style.opacity = "0.5";

  try {
    const res = await fetch("/chat", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ question })
    });

    const data = await res.json();
    
    loader.style.display = "none";
    status.innerText = "Response Delivered";
    answerContent.style.opacity = "1";
    answerContent.innerHTML = `
      <h3 style="margin-top:0; font-size: 18px;">Technical Specification</h3>
      ${data.answer ?? "No specific manual data found."}
    `;

  } catch (err) {
    loader.style.display = "none";
    status.innerText = "Error";
    answerContent.innerHTML = "<p style='color: #ff3b30;'>Unable to connect to the RAG server.</p>";
  }
}
</script>

</body>
</html>
